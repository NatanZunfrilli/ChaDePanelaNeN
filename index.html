<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lista de Presentes do Chá de Panela</title>
    <!-- 1. CARREGAR FONTE CUSTOMIZADA (Usando Great Vibes como substituto elegante para Riley) -->
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
    <!-- Configuração e Carregamento do Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Configuração customizada do Tailwind para definir a cor verde do usuário
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // Paleta personalizada baseada em rgb(112, 145, 110)
                        'casamento': {
                            100: '#e6f0e6', // Muito claro (para fundos de alerta)
                            200: '#c5dac4', // Claro (para fundo de status reservado)
                            300: '#a3c3a2', // Sombra
                            500: '#70916e', // Base (A cor exata do usuário)
                            600: '#648262', // Botões e Modal BG
                            700: '#587356', // Hover e Textos Escuros
                            800: '#4c644a', // Texto mais escuro (status reservado)
                        },
                    },
                    // 2. Adicionar a fonte customizada ao Tailwind
                    fontFamily: {
                        'riley-substitute': ['"Great Vibes"', 'cursive'],
                    }
                }
            }
        }
    </script>
    <style>
        /* Define a fonte Inter como padrão para o corpo, exceto onde especificado */
        :root {
            font-family: 'Inter', sans-serif;
        }
        /* Estilos de scrollbar simples */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-thumb {
            /* Cor do scrollbar combinando com a nova paleta */
            background-color: #a3c3a2; 
            border-radius: 4px;
        }
        .text-shadow-custom {
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }
        /* Cor de fundo suave (Fundo da página geral) */
        body {
            background-color: #fef2f2;
        }
        
        /* 3. Aumentar o tamanho da fonte no header para script fonts */
        .header-title {
            font-size: 2.75rem; /* Ajuste para ter um bom impacto visual com fonte script */
        }

        /* Ajuste para mobile */
        @media (max-width: 640px) {
             .header-title {
                font-size: 2.25rem;
            }
        }
    </style>
</head>
<body class="min-h-screen flex flex-col antialiased">

    <!-- Cabeçalho (Header) - Agora em verde "casamento-500" -->
    <header class="bg-casamento-500 shadow-lg sticky top-0 z-10">
        <div class="max-w-4xl mx-auto p-4 flex justify-between items-center">
            <!-- 4. Aplicar a nova classe de fonte e classe de tamanho customizada -->
            <h1 class="header-title font-riley-substitute font-extrabold text-white text-shadow-custom">
                Lista de Presentes
            </h1>
            <div class="text-right">
                <!-- Ícone da Marca (Monograma N & N - SVG Inline) -->
                <!-- Este SVG simula o visual do seu anexo (coroa de folhas/monograma) -->
                <!-- Para usar a sua imagem real, substitua este bloco por: <img src="URL_DA_SUA_IMAGEM" alt="Logo do Casamento" class="w-10 h-10 rounded-full border-2 border-white shadow-lg"> -->
                <img src="./Images/Icone.png" alt="Logo do Casamento" class="w-28 h-28 object-cover border-2 border-white rounded-full p-0.5 shadow-lg bg-white" />
            </div>
        </div>
    </header>

    <!-- Seção Principal de Conteúdo -->
    <main class="flex-grow max-w-4xl mx-auto p-4 w-full">
        <!-- Mensagem de carregamento e erro - Cores atualizadas -->
        <div id="loading-status" class="text-center p-6 text-gray-600">
            Carregando lista de presentes...
        </div>
        <div id="error-message" class="hidden bg-casamento-100 border-l-4 border-casamento-500 text-casamento-700 p-4 mb-4" role="alert">
            <p class="font-bold">Erro de Conexão</p>
            <p id="error-text">Não foi possível carregar a lista. Verifique sua conexão.</p>
        </div>

        <!-- ID do Usuário (Obrigatório para multi-usuário) - Cores atualizadas -->
        <div class="mb-6 p-3 bg-casamento-100 text-casamento-700 rounded-lg shadow-inner">
            <p class="text-sm font-semibold">Seu ID de Sessão (Para fins de rastreio de reserva):</p>
            <p id="user-id-display" class="text-xs break-all mt-1 font-mono"></p>
        </div>
        
        <!-- Contêiner da Lista de Presentes -->
        <div id="gift-list-container" class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
            <!-- Os cartões de presente serão injetados aqui pelo JavaScript -->
        </div>

    </main>

    <!-- Modal de Reivindicação (Claiming Modal) - Cores atualizadas -->
    <div id="claim-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 hidden items-center justify-center p-4 z-50">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-sm p-6 transform transition-all duration-300 scale-95 opacity-0" id="modal-content">
            <h2 class="text-2xl font-bold mb-4 text-casamento-600" id="modal-title">Reivindicar Presente</h2>
            <p class="text-gray-700 mb-4">Você está prestes a reservar o item: <strong id="item-name-placeholder"></strong>.</p>

            <label for="claimant-name" class="block text-sm font-medium text-gray-700 mb-1">Seu Nome:</label>
            <input type="text" id="claimant-name" placeholder="Digite seu nome (ex: Maria)" required
                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-casamento-500 mb-4 transition duration-150">

            <div class="flex justify-end space-x-3">
                <button id="cancel-claim" type="button"
                        class="px-4 py-2 text-gray-600 bg-gray-200 rounded-lg hover:bg-gray-300 transition duration-150 font-medium">
                    Cancelar
                </button>
                <button id="confirm-claim" type="button"
                        class="px-4 py-2 text-white bg-casamento-600 rounded-lg hover:bg-casamento-700 transition duration-150 font-semibold shadow-md shadow-casamento-300">
                    Confirmar Reserva
                </button>
            </div>
            <!-- Mensagem de erro do modal -->
            <p id="claim-error" class="hidden text-sm text-casamento-500 mt-3"></p>
        </div>
    </div>

    <!-- Firebase Imports e Scripts JS -->
    <script type="module">
        // Importa as funções essenciais do Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        // REMOVEMOS onAuthStateChanged pois usaremos signInAnonymously sequencialmente
        import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js"; 
        import { getFirestore, collection, getDocs, doc, setDoc, getDoc, runTransaction } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        
        // Ativar logs para depuração (opcional, mas útil)
        setLogLevel('Debug');

        // ==================================================================================
        // CREDENCIAIS DO FIREBASE FORNECIDAS PELO USUÁRIO (PROJETO: chadepanela-eeb39)
        // ==================================================================================
        const YOUR_FIREBASE_CONFIG = {
            apiKey: "AIzaSyAJbot5DSBGBRhXlBEcr4F_isF-_A4OjNU",
            authDomain: "chadepanela-eeb39.firebaseapp.com",
            projectId: "chadepanela-eeb39",
            storageBucket: "chadepanela-eeb39.firebasestorage.app",
            messagingSenderId: "399914997485",
            appId: "1:399914997485:web:3ebae86744dc9aec21dee4"
        };
        
        const firebaseConfig = YOUR_FIREBASE_CONFIG;
        // O appId é usado para criar o caminho da coleção (artifacts/{appId}/...)
        const appId = YOUR_FIREBASE_CONFIG.projectId; 
        
        // Variáveis do Firebase e do Estado do App (Declaradas como 'let' no escopo do módulo)
        let app, db, auth;
        let GIFT_ITEMS_COLLECTION_REF;
        let currentUserId = null;
        let selectedGiftId = null;

        // ==================================================================================
        // LISTA INICIAL DE PRESENTES PARA EDIÇÃO (ADMIN)
        // EDITE ESTA LISTA DIRETAMENTE NO CÓDIGO para ajustar os presentes.
        // ==================================================================================
        const INITIAL_GIFTS = [
            // Dica: Substitua 'https://placehold.co/...' pelas URLs reais das suas imagens.
            { name: "Liquidificador", claimed: false, claimantName: "", claimantId: "", imageUrl: "https://placehold.co/400x300/c5dac4/4c644a?text=Liquidificador" },
            { name: "Batedeira", claimed: false, claimantName: "", claimantId: "", imageUrl: "https://placehold.co/400x300/c5dac4/4c644a?text=Batedeira" },
            { name: "Jogo de Panelas (Antiaderente)", claimed: false, claimantName: "", claimantId: "", imageUrl: "https://placehold.co/400x300/c5dac4/4c644a?text=Jogo+de+Panelas" },
            { name: "Toalhas de Banho (Conjunto)", claimed: false, claimantName: "", claimantId: "", imageUrl: "https://placehold.co/400x300/c5dac4/4c644a?text=Toalhas+de+Banho" },
            { name: "Faça de Corte (Conjunto)", claimed: false, claimantName: "", claimantId: "", imageUrl: "https://placehold.co/400x300/c5dac4/4c644a?text=Conjunto+de+Facas" },
            { name: "Travessas de Vidro (Conjunto)", claimed: false, claimantName: "", claimantId: "", imageUrl: "https://placehold.co/400x300/c5dac4/4c644a?text=Travessas+de+Vidro" },
            { name: "Aparelho de Jantar", claimed: false, claimantName: "", claimantId: "", imageUrl: "https://placehold.co/400x300/c5dac4/4c644a?text=Aparelho+de+Jantar" },
            { name: "Jogo de Copos e Taças", claimed: false, claimantName: "", claimantId: "", imageUrl: "https://placehold.co/400x300/c5dac4/4c644a?text=Copos+e+Taças" },
            { name: "Potes Herméticos (Conjunto)", claimed: false, claimantName: "", claimantId: "", imageUrl: "https://placehold.co/400x300/c5dac4/4c644a?text=Potes+Herméticos" },
            { name: "Sanduicheira/Grill", claimed: false, claimantName: "", claimantId: "", imageUrl: "https://placehold.co/400x300/c5dac4/4c644a?text=Sanduicheira" },
            { name: "Panela de Pressão", claimed: false, claimantName: "", claimantId: "", imageUrl: "https://placehold.co/400x300/c5dac4/4c644a?text=Panela+de+Pressão" },
            { name: "Ferro de Passar Roupas", claimed: false, claimantName: "", claimantId: "", imageUrl: "https://placehold.co/400x300/c5dac4/4c644a?text=Ferro+de+Passar" },
        ];
        
        // --- Funções de UI ---

        /**
         * Renderiza um único cartão de presente.
         * @param {Object} gift - Objeto do presente com nome, claimed, claimantName, e id.
         */
        function renderGiftCard(gift) {
            const isClaimed = gift.claimed;
            
            // Classes e textos baseados no status. Usa a cor 'casamento' para RESERVADO.
            const statusClass = isClaimed ? 'bg-casamento-200 text-casamento-800' : 'bg-green-200 text-green-800';
            const statusText = isClaimed ? 'Reservado' : 'Disponível';
            
            // ATUALIZAÇÃO: O botão e o texto de ação agora sempre dizem "Reservado" se for true.
            const actionText = isClaimed ? 'Reservado' : 'Escolher Item';
            // Cor do botão de ação. Usa a cor 'casamento' para RESERVAR.
            const buttonColor = isClaimed ? 'bg-gray-400 cursor-not-allowed' : 'bg-casamento-500 hover:bg-casamento-700 shadow-md shadow-casamento-300';

            // ATUALIZAÇÃO: Conteúdo do reclamante agora é genérico para ocultar o nome.
            const claimantInfo = isClaimed 
                ? `<p class="text-sm mt-2 text-gray-700">Este item já foi reservado.</p>`
                : `<p class="text-sm mt-2 text-gray-500">Toque para reservar seu item!</p>`;


            return `
                <div class="bg-white p-5 rounded-xl shadow-lg hover:shadow-xl transition duration-300 flex flex-col justify-between border-t-4 ${isClaimed ? 'border-casamento-500' : 'border-green-500'}">
                    
                    <!-- NOVO: Imagem do Produto -->
                    <div class="mb-4 overflow-hidden rounded-lg shadow-md aspect-[4/3] bg-gray-100">
                        <img src="${gift.imageUrl || 'https://placehold.co/400x300/cccccc/333333?text=Sem+Imagem'}" 
                             alt="Imagem de ${gift.name}" 
                             class="w-full h-full object-cover transition duration-300 hover:scale-[1.03]"
                             onerror="this.onerror=null; this.src='https://placehold.co/400x300/cccccc/333333?text=Imagem+Indisponível';"
                        >
                    </div>

                    <div>
                        <span class="inline-block px-3 py-1 text-xs font-bold rounded-full ${statusClass} mb-3">
                            ${statusText}
                        </span>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">${gift.name}</h3>
                        ${claimantInfo}
                    </div>
                    <button data-id="${gift.id}" 
                            data-name="${gift.name}"
                            ${isClaimed ? 'disabled' : ''}
                            class="claim-button w-full mt-4 px-4 py-2 text-white font-semibold rounded-lg transition duration-150 ${buttonColor}">
                        ${actionText}
                    </button>
                </div>
            `;
        }

        /**
         * Atualiza a lista de presentes no HTML.
         * @param {Array} gifts - Array de objetos de presente.
         */
        function updateGiftListUI(gifts) {
            const container = document.getElementById('gift-list-container');
            const loadingStatus = document.getElementById('loading-status');
            
            loadingStatus.classList.add('hidden'); // Esconde o status de carregamento

            if (gifts.length === 0) {
                 // SE VAZIO: Mostra uma mensagem amigável (ajuda a diagnosticar falha de inicialização)
                 container.innerHTML = `
                    <div class="col-span-full text-center p-10 bg-casamento-100 rounded-xl shadow-inner border border-casamento-300">
                        <svg class="w-10 h-10 mx-auto text-casamento-500 mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10m0-6h.01"></path></svg>
                        <p class="text-xl font-bold text-casamento-700 mb-2">Lista Vazia!</p>
                        <p class="text-gray-600">
                            Parece que os presentes não foram carregados do banco de dados. 
                            <span class="font-semibold">Verifique o Console do Firebase > Firestore para confirmar se a coleção 'gift_items' existe e se as Regras de Segurança permitem escrita (write) para usuários autenticados.</span>
                        </p>
                    </div>
                 `;
                 return;
            }

            container.innerHTML = gifts.map(renderGiftCard).join('');

            // Adiciona listeners aos botões "Reservar Item"
            document.querySelectorAll('.claim-button:not([disabled])').forEach(button => {
                button.addEventListener('click', (e) => {
                    selectedGiftId = e.currentTarget.dataset.id;
                    const itemName = e.currentTarget.dataset.name;
                    openClaimModal(itemName);
                });
            });
        }
        
        // --- Funções do Modal ---

        const claimModal = document.getElementById('claim-modal');
        const modalContent = document.getElementById('modal-content');
        const itemNamePlaceholder = document.getElementById('item-name-placeholder');
        const claimantNameInput = document.getElementById('claimant-name');
        const confirmClaimButton = document.getElementById('confirm-claim');
        const cancelClaimButton = document.getElementById('cancel-claim');
        const claimError = document.getElementById('claim-error');

        /**
         * Abre o modal de reivindicação.
         * @param {string} itemName - Nome do presente a ser reivindicado.
         */
        function openClaimModal(itemName) {
            itemNamePlaceholder.textContent = itemName;
            // Tenta pré-preencher o nome do usuário se ele já reservou algo antes
            const storedName = localStorage.getItem('lastClaimantName'); 
            claimantNameInput.value = storedName || ''; 
            claimError.classList.add('hidden');
            
            claimModal.classList.remove('hidden');
            claimModal.classList.add('flex');
            // Animação de entrada
            setTimeout(() => {
                modalContent.classList.remove('scale-95', 'opacity-0');
                modalContent.classList.add('scale-100', 'opacity-100');
            }, 10);
        }

        /**
         * Fecha o modal de reivindicação.
         */
        function closeClaimModal() {
            // Animação de saída
            modalContent.classList.remove('scale-100', 'opacity-100');
            modalContent.classList.add('scale-95', 'opacity-0');
            setTimeout(() => {
                claimModal.classList.remove('flex');
                claimModal.classList.add('hidden');
                selectedGiftId = null;
            }, 300);
        }

        cancelClaimButton.addEventListener('click', closeClaimModal);
        
        // --- Funções do Firebase/Firestore ---
        
        /**
         * Popula o banco de dados com a lista inicial se estiver vazio.
         * LÓGICA REFINADA: Apenas define o marcador de inicialização após a escrita bem-sucedida de todos os presentes.
         */
        async function initializeGiftList() {
            try {
                // 1. Checa se o marcador de inicialização existe
                const docRef = doc(GIFT_ITEMS_COLLECTION_REF, 'initializer_check');
                const docSnap = await getDoc(docRef);

                if (docSnap.exists()) {
                    return;
                }

                console.log("Coleção vazia. Inicializando com presentes padrão...");

                // 2. Cria promessas para a escrita de TODOS os presentes
                const giftPromises = INITIAL_GIFTS.map(gift => {
                    const newDocRef = doc(GIFT_ITEMS_COLLECTION_REF);
                    return setDoc(newDocRef, gift);
                });
                
                // 3. Espera que TODOS os presentes sejam escritos
                await Promise.all(giftPromises); 

                // 4. Adiciona o documento marcador SOMENTE SE todos os presentes foram escritos com sucesso
                await setDoc(docRef, { initialized: true }); 

                console.log("Lista inicial de presentes adicionada com sucesso.");

            } catch (e) {
                console.error("Erro CRÍTICO ao inicializar a lista (Verifique as Regras de Escrita!):", e);
                // Exibe o erro crítico na UI para o administrador
                document.getElementById('error-text').textContent = `Erro CRÍTICO na Inicialização. Causa provável: Regras de segurança impedindo a ESCRITA (write). Erro: ${e.message}`;
                document.getElementById('error-message').classList.remove('hidden');
                throw e; // Re-lança para notificar o caller
            }
        }

        /**
         * Lógica de reivindicação de presente usando Transação para garantir atomicidade.
         */
        confirmClaimButton.addEventListener('click', async () => {
            const claimantName = claimantNameInput.value.trim();
            claimError.classList.add('hidden');

            if (!claimantName) {
                claimError.textContent = 'Por favor, insira seu nome para reservar.';
                claimError.classList.remove('hidden');
                return;
            }
            
            if (!selectedGiftId) {
                claimError.textContent = 'Erro interno: Item não selecionado.';
                claimError.classList.remove('hidden');
                return;
            }

            // Salva o nome do usuário no local storage para auto-preenchimento
            localStorage.setItem('lastClaimantName', claimantName);
            
            // Desativa o botão para evitar cliques duplos
            confirmClaimButton.disabled = true;
            confirmClaimButton.textContent = 'Reservando...';
            
            const giftRef = doc(GIFT_ITEMS_COLLECTION_REF, selectedGiftId);

            try {
                // Usa uma transação para garantir que a atualização só ocorra
                await runTransaction(db, async (transaction) => {
                    const giftDoc = await transaction.get(giftRef);

                    if (!giftDoc.exists()) {
                        throw new Error("O presente não existe mais.");
                    }

                    const data = giftDoc.data();

                    if (data.claimed) {
                        // Se já estiver reivindicado, cancela a transação e avisa o usuário
                        throw new Error(`Este presente já foi reservado por ${data.claimantName}!`);
                    }

                    // Se estiver disponível, reivindica
                    transaction.update(giftRef, {
                        claimed: true,
                        claimantName: claimantName,
                        claimantId: currentUserId,
                    });
                });

                closeClaimModal();
                // IMPORTANTE: Forçar atualização da lista imediatamente após a reserva
                await fetchGiftChanges(); 
                

            } catch (e) {
                console.error("Erro ao reivindicar presente:", e);
                // Exibe a mensagem de erro da transação (incluindo "já reivindicado")
                claimError.textContent = e.message.includes('reservado') 
                    ? e.message 
                    : 'Falha ao reservar o item. Tente novamente.';
                claimError.classList.remove('hidden');
            } finally {
                confirmClaimButton.disabled = false;
                confirmClaimButton.textContent = 'Confirmar Reserva';
            }
        });

        /**
         * Função para exibir erro de configuração (apenas como fallback)
         */
        function showConfigError() {
            document.getElementById('loading-status').textContent = 'Erro: Falha na configuração do Firebase.';
            console.error('Firebase config check failed.');
            document.getElementById('error-text').textContent = 'Erro de inicialização: Verifique suas chaves de configuração no código-fonte.';
            document.getElementById('error-message').classList.remove('hidden');
        }

        // NOVO: Função para buscar os presentes (fetch único)
        async function fetchGiftChanges() {
            try {
                // Usa getDocs para uma leitura única, economizando custos
                const snapshot = await getDocs(GIFT_ITEMS_COLLECTION_REF);
                
                const gifts = [];
                snapshot.forEach((doc) => {
                    // Ignora o documento de inicialização/marcador
                    if (doc.id !== 'initializer_check') {
                        gifts.push({ id: doc.id, ...doc.data() });
                    }
                });

                // Ordena alfabeticamente
                gifts.sort((a, b) => a.name.localeCompare(b.name));

                updateGiftListUI(gifts);
            } catch (error) {
                console.error("Erro ao buscar dados do Firestore:", error);
                
                let userFriendlyMessage = `Erro de sincronização: ${error.message}`;

                // Adição para verificar erro de permissão do Firestore (Importante para o usuário)
                if (error.code === 'permission-denied') {
                     userFriendlyMessage = `Erro Crítico (Permission Denied): Por favor, verifique se as Regras de Segurança do Firestore (chadepanela-eeb39) permitem a LEITURA ('allow read: if request.auth != null;').`;
                }

                document.getElementById('loading-status').classList.add('hidden');
                document.getElementById('error-text').textContent = userFriendlyMessage;
                document.getElementById('error-message').classList.remove('hidden');
            }
        }
        
        // NOVO: Função para iniciar o Polling a cada 15 segundos
        function startPolling() {
            fetchGiftChanges(); // Primeira busca
            // Busca a lista a cada 15 segundos (15000ms) - Polling
            setInterval(fetchGiftChanges, 15000); 
        }

        /**
         * Função principal de inicialização do aplicativo.
         */
        async function setupApp() {
            // 1. Inicializa o Firebase
            app = initializeApp(firebaseConfig);
            db = getFirestore(app);
            auth = getAuth(app);

            // Referência à coleção pública de presentes
            GIFT_ITEMS_COLLECTION_REF = collection(db, 'artifacts', appId, 'public', 'data', 'gift_items');
            
            // 2. Tenta Autenticar Anonimamente
            try {
                const userCredential = await signInAnonymously(auth);
                const user = userCredential.user;
                
                // Se a autenticação for bem-sucedida, continua a inicialização
                currentUserId = user.uid;
                document.getElementById('user-id-display').textContent = user.uid;
                
                // 3. Inicializa e Sincroniza a Lista
                await initializeGiftList();
                startPolling(); // Inicia a busca programada (Polling)
                
            } catch (error) {
                console.error("Erro Crítico de Autenticação:", error);
                
                let userFriendlyMessage = `Erro de autenticação: ${error.message}`;

                // Adiciona uma dica sobre a causa mais comum de falha no login anônimo
                if (error.code === 'auth/configuration-not-found' || error.code === 'auth/operation-not-allowed') {
                    userFriendlyMessage = `Erro Crítico (Auth): Por favor, ative o provedor 'Anonymous' no seu Console do Firebase (Authentication > Sign-in method).`;
                }

                document.getElementById('loading-status').classList.add('hidden');
                document.getElementById('error-text').textContent = userFriendlyMessage;
                document.getElementById('error-message').classList.remove('hidden');
            }
        }

        // --- Checagem e Inicialização Principal ---
        if (!firebaseConfig || !firebaseConfig.projectId) {
            showConfigError();
        } else {
            setupApp();
        }
    </script>

</body>
</html>